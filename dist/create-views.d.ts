import type { Database } from 'better-sqlite3';
/**
 * All view SQL statements
 */
export declare const allViewsSQL: readonly ["\nCREATE VIEW IF NOT EXISTS product_inventory_status AS\nSELECT\n  p.product_id,\n  p.sku,\n  p.name,\n  p.description,\n  p.item_type,\n  p.is_active,\n\n  p.category_id,\n  c.name AS category_name,\n\n  ps.quantity_on_hand,\n  ps.quantity_available,\n  ps.quantity_reserved,\n  ps.quantity_on_purchase_order,\n  ps.quantity_on_work_order,\n  ps.quantity_in_transit,\n  ps.quantity_buildable,\n\n  rs.reorder_point,\n  rs.reorder_quantity,\n  rs.enable_reordering,\n  rs.vendor_id AS preferred_vendor_id,\n\n  CASE\n    WHEN rs.enable_reordering = 1\n      AND rs.reorder_point IS NOT NULL\n      AND CAST(COALESCE(ps.quantity_available, '0') AS REAL) <= CAST(rs.reorder_point AS REAL)\n    THEN 1\n    ELSE 0\n  END AS is_below_reorder,\n\n  ps.image_small_url AS image_url\n\nFROM products p\nLEFT JOIN categories c ON p.category_id = c.category_id\nLEFT JOIN product_summary ps ON p.product_id = ps.product_id AND ps.location_id IS NULL\nLEFT JOIN reorder_settings rs ON p.product_id = rs.product_id AND rs.location_id IS NULL;\n", "\nCREATE VIEW IF NOT EXISTS reorder_alerts AS\nSELECT\n  p.product_id,\n  p.sku,\n  p.name AS product_name,\n  p.category_id,\n\n  ps.quantity_on_hand,\n  ps.quantity_available,\n  ps.quantity_on_purchase_order,\n\n  rs.reorder_point,\n  rs.reorder_quantity,\n\n  CAST(rs.reorder_point AS REAL) - CAST(COALESCE(ps.quantity_available, '0') AS REAL) AS shortfall_quantity,\n\n  COALESCE(rs.reorder_quantity,\n    CAST(rs.reorder_point AS REAL) - CAST(COALESCE(ps.quantity_available, '0') AS REAL)\n  ) AS suggested_order_quantity,\n\n  rs.vendor_id AS preferred_vendor_id,\n  v.name AS vendor_name,\n  v.vendor_code,\n\n  vi.vendor_item_code,\n  vi.cost AS vendor_cost,\n  vi.lead_time_days,\n\n  CAST(COALESCE(rs.reorder_quantity,\n    CAST(rs.reorder_point AS REAL) - CAST(COALESCE(ps.quantity_available, '0') AS REAL)\n  ) AS REAL) * CAST(COALESCE(vi.cost, '0') AS REAL) AS estimated_order_value\n\nFROM products p\nINNER JOIN reorder_settings rs ON p.product_id = rs.product_id AND rs.location_id IS NULL\nLEFT JOIN product_summary ps ON p.product_id = ps.product_id AND ps.location_id IS NULL\nLEFT JOIN vendors v ON rs.vendor_id = v.vendor_id\nLEFT JOIN vendor_items vi ON rs.vendor_id = vi.vendor_id AND p.product_id = vi.product_id\nWHERE rs.enable_reordering = 1\n  AND rs.reorder_point IS NOT NULL\n  AND CAST(COALESCE(ps.quantity_available, '0') AS REAL) <= CAST(rs.reorder_point AS REAL)\n  AND p.is_active = 1;\n", "\nCREATE VIEW IF NOT EXISTS open_orders_unified AS\nSELECT\n  po.purchase_order_id AS order_id,\n  'purchase_order' AS order_type,\n  po.order_number,\n  po.status,\n  po.order_date,\n  po.expected_date,\n  po.vendor_id AS counterparty_id,\n  v.name AS counterparty_name,\n  'vendor' AS counterparty_type,\n  po.location_id,\n  l.name AS location_name,\n  po.total,\n  po.remarks,\n  po.last_modified_date_time AS last_modified\nFROM purchase_orders po\nLEFT JOIN vendors v ON po.vendor_id = v.vendor_id\nLEFT JOIN locations l ON po.location_id = l.location_id\nWHERE po.status NOT IN ('Completed', 'Cancelled', 'Closed')\n\nUNION ALL\n\nSELECT\n  so.sales_order_id AS order_id,\n  'sales_order' AS order_type,\n  so.order_number,\n  so.status,\n  so.order_date,\n  so.expected_ship_date AS expected_date,\n  so.customer_id AS counterparty_id,\n  c.name AS counterparty_name,\n  'customer' AS counterparty_type,\n  so.location_id,\n  l.name AS location_name,\n  so.total,\n  so.remarks,\n  so.last_modified_date_time AS last_modified\nFROM sales_orders so\nLEFT JOIN customers c ON so.customer_id = c.customer_id\nLEFT JOIN locations l ON so.location_id = l.location_id\nWHERE so.status NOT IN ('Completed', 'Cancelled', 'Closed', 'Shipped')\n\nUNION ALL\n\nSELECT\n  mo.manufacturing_order_id AS order_id,\n  'manufacturing_order' AS order_type,\n  mo.order_number,\n  mo.status,\n  mo.order_date,\n  mo.expected_date,\n  mo.product_id AS counterparty_id,\n  p.name AS counterparty_name,\n  'product' AS counterparty_type,\n  mo.location_id,\n  l.name AS location_name,\n  CAST(mo.quantity AS TEXT) AS total,\n  mo.remarks,\n  mo.last_modified_date_time AS last_modified\nFROM manufacturing_orders mo\nLEFT JOIN products p ON mo.product_id = p.product_id\nLEFT JOIN locations l ON mo.location_id = l.location_id\nWHERE mo.status NOT IN ('Completed', 'Cancelled', 'Closed');\n", "\nCREATE VIEW IF NOT EXISTS inventory_by_location AS\nSELECT\n  ps.product_id,\n  ps.location_id,\n\n  p.sku,\n  p.name AS product_name,\n  p.item_type,\n  p.is_active,\n  p.category_id,\n  c.name AS category_name,\n\n  l.name AS location_name,\n  l.abbreviation AS location_abbreviation,\n  l.is_shippable,\n  l.is_receivable,\n\n  ps.quantity_on_hand,\n  ps.quantity_available,\n  ps.quantity_reserved,\n  ps.quantity_reserved_for_sales,\n  ps.quantity_reserved_for_manufacturing,\n  ps.quantity_reserved_for_transfers,\n  ps.quantity_on_purchase_order,\n  ps.quantity_on_work_order,\n  ps.quantity_on_transfer_order,\n  ps.quantity_picked,\n  ps.quantity_in_transit,\n\n  ps.image_small_url AS image_url\n\nFROM product_summary ps\nINNER JOIN products p ON ps.product_id = p.product_id\nINNER JOIN locations l ON ps.location_id = l.location_id\nLEFT JOIN categories c ON p.category_id = c.category_id\nWHERE ps.location_id IS NOT NULL;\n", "\nCREATE VIEW IF NOT EXISTS location_stock_summary AS\nSELECT\n  l.location_id,\n  l.name AS location_name,\n  l.abbreviation AS location_abbreviation,\n  l.is_shippable,\n  l.is_receivable,\n  COUNT(DISTINCT ps.product_id) AS sku_count,\n  SUM(CAST(COALESCE(ps.quantity_on_hand, '0') AS REAL)) AS total_quantity_on_hand,\n  SUM(CAST(COALESCE(ps.quantity_available, '0') AS REAL)) AS total_quantity_available,\n  SUM(CAST(COALESCE(ps.quantity_reserved, '0') AS REAL)) AS total_quantity_reserved,\n  SUM(CAST(COALESCE(ps.quantity_in_transit, '0') AS REAL)) AS total_quantity_in_transit\nFROM locations l\nLEFT JOIN product_summary ps ON l.location_id = ps.location_id\nWHERE l.is_active = 1\nGROUP BY l.location_id, l.name, l.abbreviation, l.is_shippable, l.is_receivable;\n", "\nCREATE VIEW IF NOT EXISTS location_reorder_alerts AS\nSELECT\n  p.product_id,\n  p.sku,\n  p.name AS product_name,\n  p.category_id,\n\n  rs.location_id,\n  l.name AS location_name,\n  l.abbreviation AS location_abbreviation,\n\n  ps.quantity_on_hand,\n  ps.quantity_available,\n  ps.quantity_on_purchase_order,\n  ps.quantity_in_transit,\n\n  rs.reorder_point,\n  rs.reorder_quantity,\n\n  CAST(rs.reorder_point AS REAL) - CAST(COALESCE(ps.quantity_available, '0') AS REAL) AS shortfall_quantity,\n\n  COALESCE(rs.reorder_quantity,\n    CAST(rs.reorder_point AS REAL) - CAST(COALESCE(ps.quantity_available, '0') AS REAL)\n  ) AS suggested_order_quantity,\n\n  rs.vendor_id AS preferred_vendor_id,\n  v.name AS vendor_name,\n  v.vendor_code,\n\n  vi.vendor_item_code,\n  vi.cost AS vendor_cost,\n  vi.lead_time_days,\n\n  rs.from_location_id\n\nFROM products p\nINNER JOIN reorder_settings rs ON p.product_id = rs.product_id\nINNER JOIN locations l ON rs.location_id = l.location_id\nLEFT JOIN product_summary ps ON p.product_id = ps.product_id AND rs.location_id = ps.location_id\nLEFT JOIN vendors v ON rs.vendor_id = v.vendor_id\nLEFT JOIN vendor_items vi ON rs.vendor_id = vi.vendor_id AND p.product_id = vi.product_id\nWHERE rs.enable_reordering = 1\n  AND rs.reorder_point IS NOT NULL\n  AND rs.location_id IS NOT NULL\n  AND p.is_active = 1\n  AND CAST(COALESCE(ps.quantity_available, '0') AS REAL) <= CAST(rs.reorder_point AS REAL);\n", "\nCREATE VIEW IF NOT EXISTS transfer_pipeline AS\nSELECT\n  st.stock_transfer_id,\n  st.transfer_number,\n  st.status,\n  st.transfer_date,\n  st.remarks,\n  st.last_modified_date_time AS last_modified,\n\n  st.from_location_id,\n  from_loc.name AS from_location_name,\n  from_loc.abbreviation AS from_location_abbreviation,\n\n  st.to_location_id,\n  to_loc.name AS to_location_name,\n  to_loc.abbreviation AS to_location_abbreviation,\n\n  stl.stock_transfer_line_id,\n  stl.line_num,\n  stl.product_id,\n  p.sku,\n  p.name AS product_name,\n  stl.quantity,\n  stl.from_sublocation,\n  stl.to_sublocation\n\nFROM stock_transfers st\nINNER JOIN stock_transfer_lines stl ON st.stock_transfer_id = stl.stock_transfer_id\nLEFT JOIN products p ON stl.product_id = p.product_id\nLEFT JOIN locations from_loc ON st.from_location_id = from_loc.location_id\nLEFT JOIN locations to_loc ON st.to_location_id = to_loc.location_id\nWHERE st.status NOT IN ('Completed', 'Cancelled', 'Closed');\n", "\nCREATE VIEW IF NOT EXISTS inventory_detail AS\nSELECT\n  il.inventory_line_id,\n\n  il.product_id,\n  p.sku,\n  p.name AS product_name,\n  p.item_type,\n  p.category_id,\n  c.name AS category_name,\n\n  il.location_id,\n  l.name AS location_name,\n  l.abbreviation AS location_abbreviation,\n\n  il.sublocation,\n\n  il.serial,\n  il.lot_id,\n\n  il.quantity_on_hand,\n\n  p.track_serials,\n  p.track_lots,\n  p.track_expiry,\n  p.shelf_life_days\n\nFROM inventory_lines il\nINNER JOIN products p ON il.product_id = p.product_id\nLEFT JOIN locations l ON il.location_id = l.location_id\nLEFT JOIN categories c ON p.category_id = c.category_id;\n", "\nCREATE VIEW IF NOT EXISTS stock_movement_ledger AS\n\n-- PO Receipts (inventory IN)\nSELECT\n  'PO_RECEIPT' AS movement_type,\n  po.order_date AS movement_date,\n  pol.product_id,\n  p.sku,\n  p.name AS product_name,\n  po.location_id,\n  l.name AS location_name,\n  pol.quantity_received AS quantity,\n  'PurchaseOrder' AS reference_type,\n  po.order_number AS reference_number,\n  po.purchase_order_id AS reference_id,\n  pol.purchase_order_line_id AS line_id\nFROM purchase_order_lines pol\nINNER JOIN purchase_orders po ON pol.purchase_order_id = po.purchase_order_id\nINNER JOIN products p ON pol.product_id = p.product_id\nLEFT JOIN locations l ON po.location_id = l.location_id\nWHERE CAST(COALESCE(pol.quantity_received, '0') AS REAL) > 0\n\nUNION ALL\n\n-- SO Shipments (inventory OUT - negative quantity)\nSELECT\n  'SO_SHIPMENT' AS movement_type,\n  so.order_date AS movement_date,\n  sol.product_id,\n  p.sku,\n  p.name AS product_name,\n  so.location_id,\n  l.name AS location_name,\n  '-' || sol.quantity_shipped AS quantity,\n  'SalesOrder' AS reference_type,\n  so.order_number AS reference_number,\n  so.sales_order_id AS reference_id,\n  sol.sales_order_line_id AS line_id\nFROM sales_order_lines sol\nINNER JOIN sales_orders so ON sol.sales_order_id = so.sales_order_id\nINNER JOIN products p ON sol.product_id = p.product_id\nLEFT JOIN locations l ON so.location_id = l.location_id\nWHERE CAST(COALESCE(sol.quantity_shipped, '0') AS REAL) > 0\n\nUNION ALL\n\n-- Transfers OUT (from source location - negative)\nSELECT\n  'TRANSFER_OUT' AS movement_type,\n  st.transfer_date AS movement_date,\n  stl.product_id,\n  p.sku,\n  p.name AS product_name,\n  st.from_location_id AS location_id,\n  l.name AS location_name,\n  '-' || stl.quantity AS quantity,\n  'StockTransfer' AS reference_type,\n  st.transfer_number AS reference_number,\n  st.stock_transfer_id AS reference_id,\n  stl.stock_transfer_line_id AS line_id\nFROM stock_transfer_lines stl\nINNER JOIN stock_transfers st ON stl.stock_transfer_id = st.stock_transfer_id\nINNER JOIN products p ON stl.product_id = p.product_id\nLEFT JOIN locations l ON st.from_location_id = l.location_id\nWHERE st.status IN ('Completed', 'Closed')\n\nUNION ALL\n\n-- Transfers IN (to destination location - positive)\nSELECT\n  'TRANSFER_IN' AS movement_type,\n  st.transfer_date AS movement_date,\n  stl.product_id,\n  p.sku,\n  p.name AS product_name,\n  st.to_location_id AS location_id,\n  l.name AS location_name,\n  stl.quantity AS quantity,\n  'StockTransfer' AS reference_type,\n  st.transfer_number AS reference_number,\n  st.stock_transfer_id AS reference_id,\n  stl.stock_transfer_line_id AS line_id\nFROM stock_transfer_lines stl\nINNER JOIN stock_transfers st ON stl.stock_transfer_id = st.stock_transfer_id\nINNER JOIN products p ON stl.product_id = p.product_id\nLEFT JOIN locations l ON st.to_location_id = l.location_id\nWHERE st.status IN ('Completed', 'Closed')\n\nUNION ALL\n\n-- Adjustments (can be positive or negative)\nSELECT\n  'ADJUSTMENT' AS movement_type,\n  sa.adjustment_date AS movement_date,\n  sal.product_id,\n  p.sku,\n  p.name AS product_name,\n  sa.location_id,\n  l.name AS location_name,\n  sal.quantity AS quantity,\n  'StockAdjustment' AS reference_type,\n  sa.adjustment_number AS reference_number,\n  sa.stock_adjustment_id AS reference_id,\n  sal.stock_adjustment_line_id AS line_id\nFROM stock_adjustment_lines sal\nINNER JOIN stock_adjustments sa ON sal.stock_adjustment_id = sa.stock_adjustment_id\nINNER JOIN products p ON sal.product_id = p.product_id\nLEFT JOIN locations l ON sa.location_id = l.location_id;\n", "\nCREATE VIEW IF NOT EXISTS lot_inventory AS\nSELECT\n  il.inventory_line_id,\n\n  il.product_id,\n  p.sku,\n  p.name AS product_name,\n  p.category_id,\n  c.name AS category_name,\n\n  il.location_id,\n  l.name AS location_name,\n  l.abbreviation AS location_abbreviation,\n  il.sublocation,\n\n  il.lot_id,\n  il.quantity_on_hand,\n\n  p.shelf_life_days,\n  p.track_expiry\n\nFROM inventory_lines il\nINNER JOIN products p ON il.product_id = p.product_id\nLEFT JOIN locations l ON il.location_id = l.location_id\nLEFT JOIN categories c ON p.category_id = c.category_id\nWHERE il.lot_id IS NOT NULL AND il.lot_id != '';\n", "\nCREATE VIEW IF NOT EXISTS serial_inventory AS\nSELECT\n  il.inventory_line_id,\n\n  il.product_id,\n  p.sku,\n  p.name AS product_name,\n  p.category_id,\n  c.name AS category_name,\n\n  il.location_id,\n  l.name AS location_name,\n  l.abbreviation AS location_abbreviation,\n  il.sublocation,\n\n  il.serial,\n  il.quantity_on_hand,\n\n  il.lot_id\n\nFROM inventory_lines il\nINNER JOIN products p ON il.product_id = p.product_id\nLEFT JOIN locations l ON il.location_id = l.location_id\nLEFT JOIN categories c ON p.category_id = c.category_id\nWHERE il.serial IS NOT NULL AND il.serial != '';\n", "\nCREATE VIEW IF NOT EXISTS customer_360 AS\nSELECT\n  c.customer_id,\n  c.name AS customer_name,\n  c.customer_code,\n  c.email,\n  c.phone,\n  c.is_active,\n\n  c.pricing_scheme_id,\n  ps.name AS pricing_scheme_name,\n  c.payment_terms_id,\n  pt.name AS payment_terms_name,\n\n  COALESCE(order_stats.total_orders, 0) AS total_orders,\n  COALESCE(order_stats.completed_orders, 0) AS completed_orders,\n  COALESCE(order_stats.cancelled_orders, 0) AS cancelled_orders,\n\n  COALESCE(order_stats.total_revenue, '0') AS total_revenue,\n  CASE\n    WHEN COALESCE(order_stats.completed_orders, 0) > 0\n    THEN CAST(CAST(COALESCE(order_stats.total_revenue, '0') AS REAL) / order_stats.completed_orders AS TEXT)\n    ELSE '0'\n  END AS average_order_value,\n\n  COALESCE(order_stats.open_orders, 0) AS open_orders,\n  COALESCE(order_stats.open_orders_value, '0') AS open_orders_value,\n\n  order_stats.first_order_date,\n  order_stats.last_order_date\n\nFROM customers c\nLEFT JOIN pricing_schemes ps ON c.pricing_scheme_id = ps.pricing_scheme_id\nLEFT JOIN payment_terms pt ON c.payment_terms_id = pt.payment_terms_id\nLEFT JOIN (\n  SELECT\n    customer_id,\n    COUNT(*) AS total_orders,\n    SUM(CASE WHEN status IN ('Completed', 'Shipped', 'Closed') THEN 1 ELSE 0 END) AS completed_orders,\n    SUM(CASE WHEN status = 'Cancelled' THEN 1 ELSE 0 END) AS cancelled_orders,\n    SUM(CASE WHEN status NOT IN ('Completed', 'Shipped', 'Closed', 'Cancelled') THEN 1 ELSE 0 END) AS open_orders,\n    SUM(CASE WHEN status IN ('Completed', 'Shipped', 'Closed') THEN CAST(COALESCE(total, '0') AS REAL) ELSE 0 END) AS total_revenue,\n    SUM(CASE WHEN status NOT IN ('Completed', 'Shipped', 'Closed', 'Cancelled') THEN CAST(COALESCE(total, '0') AS REAL) ELSE 0 END) AS open_orders_value,\n    MIN(order_date) AS first_order_date,\n    MAX(order_date) AS last_order_date\n  FROM sales_orders\n  GROUP BY customer_id\n) order_stats ON c.customer_id = order_stats.customer_id;\n", "\nCREATE VIEW IF NOT EXISTS vendor_scorecard AS\nSELECT\n  v.vendor_id,\n  v.name AS vendor_name,\n  v.vendor_code,\n  v.email,\n  v.phone,\n  v.is_active,\n\n  v.payment_terms_id,\n  pt.name AS payment_terms_name,\n\n  COALESCE(product_stats.products_supplied, 0) AS products_supplied,\n  product_stats.avg_lead_time_days,\n\n  COALESCE(po_stats.total_pos, 0) AS total_pos,\n  COALESCE(po_stats.completed_pos, 0) AS completed_pos,\n  COALESCE(po_stats.cancelled_pos, 0) AS cancelled_pos,\n  COALESCE(po_stats.open_pos, 0) AS open_pos,\n\n  COALESCE(po_stats.total_spend, '0') AS total_spend,\n  CASE\n    WHEN COALESCE(po_stats.completed_pos, 0) > 0\n    THEN CAST(CAST(COALESCE(po_stats.total_spend, '0') AS REAL) / po_stats.completed_pos AS TEXT)\n    ELSE '0'\n  END AS average_po_value,\n  COALESCE(po_stats.open_pos_value, '0') AS open_pos_value,\n\n  po_stats.first_po_date,\n  po_stats.last_po_date\n\nFROM vendors v\nLEFT JOIN payment_terms pt ON v.payment_terms_id = pt.payment_terms_id\nLEFT JOIN (\n  SELECT\n    vendor_id,\n    COUNT(DISTINCT product_id) AS products_supplied,\n    AVG(lead_time_days) AS avg_lead_time_days\n  FROM vendor_items\n  GROUP BY vendor_id\n) product_stats ON v.vendor_id = product_stats.vendor_id\nLEFT JOIN (\n  SELECT\n    vendor_id,\n    COUNT(*) AS total_pos,\n    SUM(CASE WHEN status IN ('Completed', 'Closed') THEN 1 ELSE 0 END) AS completed_pos,\n    SUM(CASE WHEN status = 'Cancelled' THEN 1 ELSE 0 END) AS cancelled_pos,\n    SUM(CASE WHEN status NOT IN ('Completed', 'Closed', 'Cancelled') THEN 1 ELSE 0 END) AS open_pos,\n    SUM(CASE WHEN status IN ('Completed', 'Closed') THEN CAST(COALESCE(total, '0') AS REAL) ELSE 0 END) AS total_spend,\n    SUM(CASE WHEN status NOT IN ('Completed', 'Closed', 'Cancelled') THEN CAST(COALESCE(total, '0') AS REAL) ELSE 0 END) AS open_pos_value,\n    MIN(order_date) AS first_po_date,\n    MAX(order_date) AS last_po_date\n  FROM purchase_orders\n  GROUP BY vendor_id\n) po_stats ON v.vendor_id = po_stats.vendor_id;\n", "\nCREATE VIEW IF NOT EXISTS product_margin AS\nSELECT\n  p.product_id,\n  p.sku,\n  p.name AS product_name,\n  p.category_id,\n  c.name AS category_name,\n  p.item_type,\n  p.is_active,\n\n  pp.price AS default_sell_price,\n  pp.pricing_scheme_id,\n  ps.name AS pricing_scheme_name,\n\n  vendor_cost.cost AS vendor_cost,\n  vendor_cost.vendor_id AS preferred_vendor_id,\n  v.name AS preferred_vendor_name,\n\n  CAST(COALESCE(CAST(pp.price AS REAL), 0) - COALESCE(CAST(vendor_cost.cost AS REAL), 0) AS TEXT) AS margin_amount,\n\n  CASE\n    WHEN COALESCE(CAST(pp.price AS REAL), 0) > 0\n    THEN CAST(\n      ((COALESCE(CAST(pp.price AS REAL), 0) - COALESCE(CAST(vendor_cost.cost AS REAL), 0)) / CAST(pp.price AS REAL)) * 100\n      AS TEXT\n    )\n    ELSE NULL\n  END AS margin_percent,\n\n  CASE\n    WHEN COALESCE(CAST(vendor_cost.cost AS REAL), 0) > 0\n    THEN CAST(\n      ((COALESCE(CAST(pp.price AS REAL), 0) - COALESCE(CAST(vendor_cost.cost AS REAL), 0)) / CAST(vendor_cost.cost AS REAL)) * 100\n      AS TEXT\n    )\n    ELSE NULL\n  END AS markup_percent\n\nFROM products p\nLEFT JOIN categories c ON p.category_id = c.category_id\nLEFT JOIN product_prices pp ON p.product_id = pp.product_id\nLEFT JOIN pricing_schemes ps ON pp.pricing_scheme_id = ps.pricing_scheme_id\nLEFT JOIN (\n  SELECT\n    vi.product_id,\n    vi.vendor_id,\n    vi.cost,\n    ROW_NUMBER() OVER (\n      PARTITION BY vi.product_id\n      ORDER BY\n        CASE WHEN rs.vendor_id IS NOT NULL THEN 0 ELSE 1 END,\n        CAST(vi.cost AS REAL) ASC\n    ) AS rn\n  FROM vendor_items vi\n  LEFT JOIN reorder_settings rs ON vi.product_id = rs.product_id\n    AND vi.vendor_id = rs.vendor_id\n    AND rs.location_id IS NULL\n) vendor_cost ON p.product_id = vendor_cost.product_id AND vendor_cost.rn = 1\nLEFT JOIN vendors v ON vendor_cost.vendor_id = v.vendor_id\nWHERE pp.pricing_scheme_id IS NULL OR ps.is_default = 1;\n", "\nCREATE VIEW IF NOT EXISTS bom_costed AS\nSELECT\n  bom.item_bom_id,\n\n  bom.parent_product_id,\n  parent.sku AS parent_sku,\n  parent.name AS parent_product_name,\n\n  bom.component_product_id,\n  component.sku AS component_sku,\n  component.name AS component_product_name,\n\n  bom.quantity,\n\n  COALESCE(component_cost.cost, '0') AS component_unit_cost,\n  component_cost.vendor_id AS component_vendor_id,\n  v.name AS component_vendor_name,\n\n  CAST(CAST(bom.quantity AS REAL) * COALESCE(CAST(component_cost.cost AS REAL), 0) AS TEXT) AS line_cost,\n\n  bom_totals.total_bom_cost,\n  bom_totals.component_count\n\nFROM item_boms bom\nINNER JOIN products parent ON bom.parent_product_id = parent.product_id\nINNER JOIN products component ON bom.component_product_id = component.product_id\nLEFT JOIN (\n  SELECT\n    vi.product_id,\n    vi.vendor_id,\n    vi.cost,\n    ROW_NUMBER() OVER (\n      PARTITION BY vi.product_id\n      ORDER BY\n        CASE WHEN rs.vendor_id IS NOT NULL THEN 0 ELSE 1 END,\n        CAST(vi.cost AS REAL) ASC\n    ) AS rn\n  FROM vendor_items vi\n  LEFT JOIN reorder_settings rs ON vi.product_id = rs.product_id\n    AND vi.vendor_id = rs.vendor_id\n    AND rs.location_id IS NULL\n) component_cost ON bom.component_product_id = component_cost.product_id AND component_cost.rn = 1\nLEFT JOIN vendors v ON component_cost.vendor_id = v.vendor_id\nLEFT JOIN (\n  SELECT\n    b.parent_product_id,\n    COUNT(*) AS component_count,\n    SUM(CAST(b.quantity AS REAL) * COALESCE(CAST(vc.cost AS REAL), 0)) AS total_bom_cost\n  FROM item_boms b\n  LEFT JOIN (\n    SELECT\n      vi.product_id,\n      vi.cost,\n      ROW_NUMBER() OVER (\n        PARTITION BY vi.product_id\n        ORDER BY CAST(vi.cost AS REAL) ASC\n      ) AS rn\n    FROM vendor_items vi\n  ) vc ON b.component_product_id = vc.product_id AND vc.rn = 1\n  GROUP BY b.parent_product_id\n) bom_totals ON bom.parent_product_id = bom_totals.parent_product_id;\n", "\nCREATE VIEW IF NOT EXISTS category_inventory_summary AS\nSELECT\n  c.category_id,\n  c.name AS category_name,\n  c.parent_category_id,\n  pc.name AS parent_category_name,\n\n  COUNT(DISTINCT p.product_id) AS sku_count,\n  SUM(CASE WHEN p.is_active = 1 THEN 1 ELSE 0 END) AS active_sku_count,\n\n  SUM(CAST(COALESCE(ps.quantity_on_hand, '0') AS REAL)) AS total_quantity_on_hand,\n  SUM(CAST(COALESCE(ps.quantity_available, '0') AS REAL)) AS total_quantity_available,\n  SUM(CAST(COALESCE(ps.quantity_reserved, '0') AS REAL)) AS total_quantity_reserved,\n  SUM(CAST(COALESCE(ps.quantity_on_purchase_order, '0') AS REAL)) AS total_quantity_on_purchase_order,\n  SUM(CAST(COALESCE(ps.quantity_on_sales_order, '0') AS REAL)) AS total_quantity_on_sales_order,\n\n  CAST(SUM(\n    CAST(COALESCE(ps.quantity_on_hand, '0') AS REAL) *\n    CAST(COALESCE(ps.average_cost, '0') AS REAL)\n  ) AS TEXT) AS total_stock_value\n\nFROM categories c\nLEFT JOIN categories pc ON c.parent_category_id = pc.category_id\nLEFT JOIN products p ON c.category_id = p.category_id\nLEFT JOIN product_summary ps ON p.product_id = ps.product_id AND ps.location_id IS NULL\nGROUP BY c.category_id, c.name, c.parent_category_id, pc.name;\n", "\nCREATE VIEW IF NOT EXISTS order_history AS\n\n-- Purchase Orders (completed receipts from vendors)\nSELECT\n  'PO' AS order_type,\n  po.purchase_order_id AS order_id,\n  po.order_number,\n  po.order_date,\n  po.status,\n  po.vendor_id AS partner_id,\n  v.name AS partner_name,\n  po.location_id,\n  l.name AS location_name,\n  pol.purchase_order_line_id AS line_id,\n  pol.product_id,\n  p.sku,\n  p.name AS product_name,\n  pol.quantity AS quantity_ordered,\n  pol.quantity_received AS quantity_fulfilled,\n  pol.unit_cost AS unit_price,\n  CAST(CAST(COALESCE(pol.quantity_received, '0') AS REAL) * CAST(COALESCE(pol.unit_cost, '0') AS REAL) AS TEXT) AS line_total\nFROM purchase_orders po\nINNER JOIN purchase_order_lines pol ON po.purchase_order_id = pol.purchase_order_id\nINNER JOIN products p ON pol.product_id = p.product_id\nLEFT JOIN vendors v ON po.vendor_id = v.vendor_id\nLEFT JOIN locations l ON po.location_id = l.location_id\nWHERE LOWER(po.status) IN ('completed', 'closed', 'fulfilled')\n\nUNION ALL\n\n-- Sales Orders (completed shipments to customers)\nSELECT\n  'SO' AS order_type,\n  so.sales_order_id AS order_id,\n  so.order_number,\n  so.order_date,\n  so.status,\n  so.customer_id AS partner_id,\n  c.name AS partner_name,\n  so.location_id,\n  l.name AS location_name,\n  sol.sales_order_line_id AS line_id,\n  sol.product_id,\n  p.sku,\n  p.name AS product_name,\n  sol.quantity AS quantity_ordered,\n  sol.quantity_shipped AS quantity_fulfilled,\n  sol.unit_price AS unit_price,\n  CAST(CAST(COALESCE(sol.quantity_shipped, '0') AS REAL) * CAST(COALESCE(sol.unit_price, '0') AS REAL) AS TEXT) AS line_total\nFROM sales_orders so\nINNER JOIN sales_order_lines sol ON so.sales_order_id = sol.sales_order_id\nINNER JOIN products p ON sol.product_id = p.product_id\nLEFT JOIN customers c ON so.customer_id = c.customer_id\nLEFT JOIN locations l ON so.location_id = l.location_id\nWHERE LOWER(so.status) IN ('completed', 'shipped', 'closed', 'fulfilled')\n\nUNION ALL\n\n-- Manufacturing Orders (completed production)\nSELECT\n  'MO' AS order_type,\n  mo.manufacturing_order_id AS order_id,\n  mo.order_number,\n  mo.order_date,\n  mo.status,\n  NULL AS partner_id,\n  NULL AS partner_name,\n  mo.location_id,\n  l.name AS location_name,\n  mo.manufacturing_order_id AS line_id,\n  mo.product_id,\n  p.sku,\n  p.name AS product_name,\n  mo.quantity AS quantity_ordered,\n  mo.quantity_completed AS quantity_fulfilled,\n  NULL AS unit_price,\n  NULL AS line_total\nFROM manufacturing_orders mo\nINNER JOIN products p ON mo.product_id = p.product_id\nLEFT JOIN locations l ON mo.location_id = l.location_id\nWHERE LOWER(mo.status) IN ('completed', 'closed');\n", "\nCREATE VIEW IF NOT EXISTS product_velocity AS\nSELECT\n  p.product_id,\n  p.sku,\n  p.name AS product_name,\n  p.category_id,\n  c.name AS category_name,\n  COALESCE(ps.quantity_on_hand, '0') AS quantity_on_hand,\n  COALESCE(sales.sold_7d, '0') AS sold_7d,\n  COALESCE(sales.sold_30d, '0') AS sold_30d,\n  COALESCE(sales.sold_90d, '0') AS sold_90d,\n  CASE\n    WHEN COALESCE(sales.sold_30d, 0) > 0\n    THEN CAST(CAST(sales.sold_30d AS REAL) / 30.0 AS TEXT)\n    ELSE '0'\n  END AS avg_daily_sales,\n  CASE\n    WHEN COALESCE(sales.sold_30d, 0) > 0\n    THEN CAST(\n      CAST(COALESCE(ps.quantity_on_hand, '0') AS REAL) /\n      (CAST(sales.sold_30d AS REAL) / 30.0)\n      AS TEXT\n    )\n    ELSE NULL\n  END AS days_of_stock,\n  sales.last_sale_date,\n  CASE\n    WHEN COALESCE(sales.sold_30d, 0) / 30.0 > 1 THEN 'FAST'\n    WHEN COALESCE(sales.sold_30d, 0) / 30.0 > 0.1 THEN 'MEDIUM'\n    ELSE 'SLOW'\n  END AS velocity_tier\nFROM products p\nLEFT JOIN categories c ON p.category_id = c.category_id\nLEFT JOIN product_summary ps ON p.product_id = ps.product_id AND ps.location_id IS NULL\nLEFT JOIN (\n  SELECT\n    sol.product_id,\n    SUM(CASE\n      WHEN julianday('now') - julianday(so.order_date) <= 7\n      THEN CAST(COALESCE(sol.quantity_shipped, '0') AS REAL)\n      ELSE 0\n    END) AS sold_7d,\n    SUM(CASE\n      WHEN julianday('now') - julianday(so.order_date) <= 30\n      THEN CAST(COALESCE(sol.quantity_shipped, '0') AS REAL)\n      ELSE 0\n    END) AS sold_30d,\n    SUM(CASE\n      WHEN julianday('now') - julianday(so.order_date) <= 90\n      THEN CAST(COALESCE(sol.quantity_shipped, '0') AS REAL)\n      ELSE 0\n    END) AS sold_90d,\n    MAX(so.order_date) AS last_sale_date\n  FROM sales_order_lines sol\n  INNER JOIN sales_orders so ON sol.sales_order_id = so.sales_order_id\n  WHERE LOWER(so.status) IN ('completed', 'shipped', 'closed', 'fulfilled')\n    AND julianday('now') - julianday(so.order_date) <= 90\n  GROUP BY sol.product_id\n) sales ON p.product_id = sales.product_id\nWHERE p.is_active = 1;\n", "\nCREATE VIEW IF NOT EXISTS dead_stock AS\nSELECT\n  inv.product_id,\n  inv.sku,\n  inv.product_name,\n  inv.category_id,\n  inv.category_name,\n  inv.location_id,\n  inv.location_name,\n  inv.quantity_on_hand,\n  inv.unit_cost,\n  CAST(\n    CAST(COALESCE(inv.quantity_on_hand, '0') AS REAL) *\n    CAST(COALESCE(inv.unit_cost, '0') AS REAL)\n    AS TEXT\n  ) AS total_value,\n  movements.last_movement_date,\n  CAST(julianday('now') - julianday(COALESCE(movements.last_movement_date, '1900-01-01')) AS INTEGER) AS days_since_movement,\n  CASE\n    WHEN julianday('now') - julianday(COALESCE(movements.last_movement_date, '1900-01-01')) >= 90 THEN '90+'\n    WHEN julianday('now') - julianday(COALESCE(movements.last_movement_date, '1900-01-01')) >= 60 THEN '60+'\n    WHEN julianday('now') - julianday(COALESCE(movements.last_movement_date, '1900-01-01')) >= 30 THEN '30+'\n    ELSE NULL\n  END AS dead_stock_tier\nFROM (\n  -- Current inventory by product/location with vendor cost\n  SELECT\n    ps.product_id,\n    p.sku,\n    p.name AS product_name,\n    p.category_id,\n    c.name AS category_name,\n    ps.location_id,\n    l.name AS location_name,\n    ps.quantity_on_hand,\n    vi.cost AS unit_cost\n  FROM product_summary ps\n  INNER JOIN products p ON ps.product_id = p.product_id\n  LEFT JOIN categories c ON p.category_id = c.category_id\n  LEFT JOIN locations l ON ps.location_id = l.location_id\n  LEFT JOIN (\n    SELECT product_id, cost,\n      ROW_NUMBER() OVER (PARTITION BY product_id ORDER BY CAST(cost AS REAL) ASC) AS rn\n    FROM vendor_items\n  ) vi ON p.product_id = vi.product_id AND vi.rn = 1\n  WHERE ps.location_id IS NOT NULL\n    AND CAST(COALESCE(ps.quantity_on_hand, '0') AS REAL) > 0\n) inv\nLEFT JOIN (\n  -- Last movement date per product/location from all movement sources\n  SELECT\n    product_id,\n    location_id,\n    MAX(movement_date) AS last_movement_date\n  FROM (\n    -- PO Receipts\n    SELECT\n      pol.product_id,\n      po.location_id,\n      po.order_date AS movement_date\n    FROM purchase_order_lines pol\n    INNER JOIN purchase_orders po ON pol.purchase_order_id = po.purchase_order_id\n    WHERE LOWER(po.status) IN ('completed', 'closed', 'fulfilled')\n      AND CAST(COALESCE(pol.quantity_received, '0') AS REAL) > 0\n\n    UNION ALL\n\n    -- SO Shipments\n    SELECT\n      sol.product_id,\n      so.location_id,\n      so.order_date AS movement_date\n    FROM sales_order_lines sol\n    INNER JOIN sales_orders so ON sol.sales_order_id = so.sales_order_id\n    WHERE LOWER(so.status) IN ('completed', 'shipped', 'closed', 'fulfilled')\n      AND CAST(COALESCE(sol.quantity_shipped, '0') AS REAL) > 0\n\n    UNION ALL\n\n    -- Transfers OUT\n    SELECT\n      stl.product_id,\n      st.from_location_id AS location_id,\n      st.transfer_date AS movement_date\n    FROM stock_transfer_lines stl\n    INNER JOIN stock_transfers st ON stl.stock_transfer_id = st.stock_transfer_id\n    WHERE LOWER(st.status) IN ('completed', 'closed')\n\n    UNION ALL\n\n    -- Transfers IN\n    SELECT\n      stl.product_id,\n      st.to_location_id AS location_id,\n      st.transfer_date AS movement_date\n    FROM stock_transfer_lines stl\n    INNER JOIN stock_transfers st ON stl.stock_transfer_id = st.stock_transfer_id\n    WHERE LOWER(st.status) IN ('completed', 'closed')\n\n    UNION ALL\n\n    -- Adjustments\n    SELECT\n      sal.product_id,\n      sa.location_id,\n      sa.adjustment_date AS movement_date\n    FROM stock_adjustment_lines sal\n    INNER JOIN stock_adjustments sa ON sal.stock_adjustment_id = sa.stock_adjustment_id\n  ) all_movements\n  GROUP BY product_id, location_id\n) movements ON inv.product_id = movements.product_id\n           AND inv.location_id = movements.location_id\nWHERE julianday('now') - julianday(COALESCE(movements.last_movement_date, '1900-01-01')) >= 30;\n"];
/**
 * View names for dropping/recreating
 */
export declare const viewNames: readonly ["product_inventory_status", "reorder_alerts", "open_orders_unified", "inventory_by_location", "location_stock_summary", "location_reorder_alerts", "transfer_pipeline", "inventory_detail", "stock_movement_ledger", "lot_inventory", "serial_inventory", "customer_360", "vendor_scorecard", "product_margin", "bom_costed", "category_inventory_summary", "order_history", "product_velocity", "dead_stock"];
export type ViewName = (typeof viewNames)[number];
/**
 * Create all materialized views in the database
 *
 * @param db - better-sqlite3 Database instance (from inflow-get)
 * @param options - Configuration options
 */
export declare function createViews(db: Database, options?: {
    /** Drop existing views before creating (default: true) */
    dropExisting?: boolean;
    /** Only create specific views */
    only?: ViewName[];
}): void;
/**
 * Drop all materialized views from the database
 */
export declare function dropViews(db: Database, only?: ViewName[]): void;
//# sourceMappingURL=create-views.d.ts.map